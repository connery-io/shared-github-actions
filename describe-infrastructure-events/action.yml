name: Describe infrastructure events

inputs:
  repository:
    description: GitHub repository name
    required: true
  environment:
    description: Environment
    required: true
  organization:
    description: Organization
    required: false
  stack:
    description: CloudFormation stack name (e.g. service)
    required: true

runs:
  using: composite
  steps:
    - name: Describe infrastructure events
      shell: bash
      run: |
        if [[ "${{ inputs.organization }}" ]]
        then
          aws cloudformation describe-stack-events --stack-name ${{ format('{0}-{1}-{2}-{3}', inputs.repository, inputs.environment, inputs.organization, inputs.stack) }}
        else
          aws cloudformation describe-stack-events --stack-name ${{ format('{0}-{1}-{2}', inputs.repository, inputs.environment, inputs.stack) }}
        fi
